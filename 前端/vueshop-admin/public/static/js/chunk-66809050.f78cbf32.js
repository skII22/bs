(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66809050"],{1:function(t,e){},2:function(t,e){},"57f3":function(t,e,l){},aeb1:function(t,e,l){"use strict";l("57f3")},ca1e:function(t,e,l){"use strict";l.r(e);var i=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("div",[l("el-button",{attrs:{icon:"el-icon-plus",type:"primary",plain:""},on:{click:function(e){return t.handleAdd()}}},[t._v("添加商品")]),l("el-button",{attrs:{icon:"el-icon-delete",type:"danger",plain:"",disabled:0===t.multipleSelection.length},on:{click:function(e){return t.handleDeleteItem(t.multipleSelection)}}},[t._v("删除")])],1),l("div",[l("el-table",{staticStyle:{width:"100%"},attrs:{data:t.products,border:!1},on:{"selection-change":t.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection","show-overflow-tooltip":!0}}),t._v(" // 表头 "),l("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"180",align:"center"}}),l("el-table-column",{staticStyle:{"background-color":"#99a9bf"},attrs:{prop:"price",label:"商品价格",width:"180",align:"center"}}),l("el-table-column",{staticStyle:{"background-color":"#99a9bf"},attrs:{prop:"title",label:"标题",width:"180",align:"center"}}),l("el-table-column",{staticStyle:{"background-color":"#99a9bf"},attrs:{prop:"intro",label:"商品介绍",width:"180",align:"center"}}),t._v(" // 图片上传 "),l("el-table-column",{attrs:{label:"图片",width:"180px",prop:"imageUrl",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[l("div",[l("el-image",{attrs:{src:t.row.imageUrl,height:"180",width:"150"}})],1)]}}])}),l("el-table-column",{staticStyle:{"background-color":"#99a9bf"},attrs:{prop:"sellingPrice",label:"售卖价格",width:"180",align:"center"}}),l("el-table-column",{staticStyle:{"background-color":"#99a9bf"},attrs:{prop:"num",label:"数量",width:"180",align:"center"}}),l("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{size:"mini"},on:{click:function(l){t.handleEdit(e.row),t.showEditModal=!0}}},[t._v("编辑")]),l("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(l){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1)],1),t.showForm?l("div",[l("el-dialog",{staticClass:"addForm",staticStyle:{"overflow-x":"hidden"},attrs:{visible:t.showForm,"close-on-click-modal":!1,"before-close":t.resetForm},on:{"update:visible":function(e){t.showForm=e}}},[l("el-scrollbar",[l("el-form",{ref:"resetForm",staticStyle:{height:"600px"},on:{submit:function(e){return e.preventDefault(),t.addProduct(e)}}},[l("el-form-item",{attrs:{label:"商品名称："}},[l("el-input",{staticStyle:{width:"180px","padding-left":"10px"},attrs:{type:"text",required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),l("el-form-item",{attrs:{label:"商品价格："}},[l("el-input",{staticStyle:{width:"180px","padding-left":"10px"},attrs:{required:""},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),l("el-form-item",{attrs:{label:"类型："}},[l("el-select",{staticStyle:{width:"210px","padding-left":"38px"},attrs:{placeholder:"请选择商品类型",required:""},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},[l("el-option",{attrs:{label:"手机",value:"1"}}),l("el-option",{attrs:{label:"电视机",value:"2"}}),l("el-option",{attrs:{label:"空调",value:"3"}}),l("el-option",{attrs:{label:"洗衣机",value:"4"}}),l("el-option",{attrs:{label:"保护套",value:"5"}}),l("el-option",{attrs:{label:"保护膜",value:"6"}}),l("el-option",{attrs:{label:"充电器",value:"7"}}),l("el-option",{attrs:{label:"充电宝",value:"8"}})],1)],1),l("el-form-item",{attrs:{label:"标题："}},[l("el-input",{staticStyle:{width:"380px","padding-left":"38px"},attrs:{required:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),l("el-form-item",{attrs:{label:"商品介绍："}},[l("el-input",{staticStyle:{width:"353px","padding-left":"8px"},attrs:{required:""},model:{value:t.form.intro,callback:function(e){t.$set(t.form,"intro",e)},expression:"form.intro"}})],1),l("el-form-item",[l("a",[t._v("图片:")]),l("el-upload",{ref:"uploadAdd",attrs:{action:"/api/product/upload",data:t.form,"list-type":"picture-card","auto-upload":!1,limit:1,"on-change":t.handleChange,"on-success":t.handleUploadSubmitAdd,"on-exceed":t.handleBeforeUpload,"file-list":t.fileList},scopedSlots:t._u([{key:"file",fn:function(e){var i=e.file;return l("div",{},[l("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:i.url,alt:""}}),l("span",{staticClass:"el-upload-list__item-actions"},[l("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(i)}}},[l("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():l("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleDownload(i)}}},[l("i",{staticClass:"el-icon-download"})]),t.disabled?t._e():l("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(i)}}},[l("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,537993531)},[l("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),l("el-form-item",{attrs:{label:"售卖价格："}},[l("el-input",{staticStyle:{width:"180px","padding-left":"7px"},attrs:{required:""},model:{value:t.form.sellingPrice,callback:function(e){t.$set(t.form,"sellingPrice",e)},expression:"form.sellingPrice"}})],1),l("el-form-item",{attrs:{label:"数量："}},[l("el-input",{staticStyle:{width:"207px","padding-left":"34px"},attrs:{required:""},model:{value:t.form.num,callback:function(e){t.$set(t.form,"num",e)},expression:"form.num"}})],1),l("div",{staticStyle:{"text-align":"center"}},[l("el-button",{attrs:{type:"primary"},on:{click:t.addProduct}},[t._v("确认添加")]),l("el-button",{attrs:{type:"danger"},on:{click:t.resetForm}},[t._v("取消")])],1)],1)],1)],1),l("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[l("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1):t._e(),t.showEditModal?l("div",{staticClass:"editForm"},[l("el-dialog",{attrs:{visible:t.showEditModal,"close-on-click-modal":!1},on:{"update:visible":function(e){t.showEditModal=e}}},[l("el-form",{ref:"form",attrs:{model:t.currentItem},on:{submit:function(e){return e.preventDefault(),t.addProduct(e)}}},[l("el-form-item",{attrs:{label:"商品名称："}},[l("el-input",{attrs:{type:"text",required:""},model:{value:t.currentItem.name,callback:function(e){t.$set(t.currentItem,"name",e)},expression:"currentItem.name"}})],1),l("el-form-item",{attrs:{label:"商品价格："}},[l("el-input",{attrs:{required:""},model:{value:t.currentItem.price,callback:function(e){t.$set(t.currentItem,"price",t._n(e))},expression:"currentItem.price"}})],1),l("el-form-item",{attrs:{label:"类型："}},[l("el-select",{attrs:{placeholder:"请选择商品类型",required:""},model:{value:t.currentItem.categoryId,callback:function(e){t.$set(t.currentItem,"categoryId",e)},expression:"currentItem.categoryId"}},t._l(this.options,(function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),l("el-form-item",{attrs:{label:"标题："}},[l("el-input",{attrs:{required:""},model:{value:t.currentItem.title,callback:function(e){t.$set(t.currentItem,"title",e)},expression:"currentItem.title"}})],1),l("el-form-item",{attrs:{label:"商品介绍："}},[l("el-input",{attrs:{required:""},model:{value:t.currentItem.intro,callback:function(e){t.$set(t.currentItem,"intro",e)},expression:"currentItem.intro"}})],1),l("el-form-item",[l("a",[t._v("图片:")]),l("el-upload",{ref:"uploadEdit",attrs:{action:"/api/product/upload-edit","list-type":"picture-card","auto-upload":!0,limit:1,data:t.currentItem,"on-success":t.handleUploadSubmit,"on-exceed":t.handleBeforeUpload,"file-list":t.fileList},scopedSlots:t._u([{key:"file",fn:function(e){var i=e.file;return l("div",{},[i.url?l("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:i.url,alt:""}}):t._e(),l("span",{staticClass:"el-upload-list__item-actions"},[l("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(i)}}},[l("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():l("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleDownload(i)}}},[l("i",{staticClass:"el-icon-download"})]),t.disabled?t._e():l("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(i)}}},[l("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,633892967)},[l("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),l("el-form-item",{attrs:{label:"售卖价格："}},[l("el-input",{attrs:{required:""},model:{value:t.currentItem.sellingPrice,callback:function(e){t.$set(t.currentItem,"sellingPrice",e)},expression:"currentItem.sellingPrice"}})],1),l("el-form-item",{attrs:{label:"数量："}},[l("el-input",{attrs:{required:""},model:{value:t.currentItem.num,callback:function(e){t.$set(t.currentItem,"num",e)},expression:"currentItem.num"}})],1),l("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确认编辑")]),l("el-button",{on:{click:function(e){t.showEditModal=!1}}},[t._v("取消")])],1)],1),l("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[l("img",{attrs:{width:"50%",src:t.dialogImageUrl,alt:""}})])],1):t._e()])},a=[],r=l("2909"),n=(l("d3b7"),l("159b"),l("d81d"),l("b0c0"),l("a434"),l("c740"),l("0b16"),l("bc3a")),o=l.n(n),s=(l("0941"),l("f68e"),l("30c4"),l("3fd3"),l("837c"),{data:function(){return{products:[],showForm:!1,showEditForm:!1,form:{name:"",title:"",categoryId:"",intro:"",imageUrl:"",price:null,sellingPrice:null,num:null},showEditModal:!1,currentItem:{name:"",title:"",categoryId:"",intro:"",imageUrl:"",price:null,sellingPrice:null,num:null},multipleSelection:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,fileList:[],deleteList:[],options:[{value:1,label:"手机"},{value:2,label:"电视机"},{value:3,label:"空调"},{value:4,label:"洗衣机"},{value:5,label:"保护套"},{value:6,label:"保护膜"},{value:7,label:"充电器"},{value:8,label:"充电宝"}]}},mounted:function(){this.getProduct()},methods:{getProduct:function(){var t=this;o.a.get("/api/product/getAll").then((function(e){t.products=e.data.data,t.products.forEach((function(t){t.categoryId=t.categoryId+1}))}))},handleAdd:function(){this.form={},this.fileList=[],this.showForm=!0},addProduct:function(){var t=this;this.$refs.uploadAdd.submit(),console.log(this.fileList);var e=Math.max.apply(Math,Object(r["a"])(this.products.map((function(t){return t.id}))));this.products.forEach((function(t,e){t.id=e+1}));var l={id:e+1,name:this.form.name,price:this.form.price,imageUrl:this.form.imageUrl,title:this.form.title,categoryId:this.form.categoryId,intro:this.form.intro,sellingPrice:this.form.sellingPrice,num:this.form.num};0===this.fileList.length?this.$nextTick((function(){t.$message.warning("请上传一个图片")})):(this.showForm=!1,this.products.push(l),this.$message.success("添加商品成功"),this.resetForm())},resetForm:function(){this.products=this.products,this.showForm=!1,this.form={name:"",price:null}},handleSelectionChange:function(t){this.multipleSelection=t},handleDelete:function(t){var e=this;this.deleteList=[],this.deleteList[0]=t.id;var l=this.deleteList;o.a.post("/api/product/delete",l,{headers:{"Content-Type":"application/json"}}).then((function(l){if(200===l.data.code){var i=e.products.indexOf(t);-1!==i&&e.products.splice(i,1)}e.deleteList=[],200===l.data.code?e.$message(l.data.msg):e.$message.error(l.data.msg)})).catch((function(t){e.$message.error(t)}))},handleDeleteItem:function(t){var e=this;t.forEach((function(t){e.deleteList.push(t.id)})),o.a.post("/api/product/delete",this.deleteList).then((function(l){200===l.data.code&&(0===t.length&&e.$message.error("请选择数据再点击"),e.deleteList=[],t.forEach((function(t){var l=e.products.findIndex((function(e){return e.id===t.id}));-1!==l&&e.products.splice(l,1)}))),e.fileList=[],200===l.data.code?e.$message(l.data.msg):e.$message.error(l.data.msg)})).catch((function(t){e.$message.error(t)}))},handleEdit:function(t){if(this.currentItem=Object.assign({},t),""!=t.imageUrl){var e=[];e.push(t.imageUrl),this.fileList=e.map((function(t,e){return{name:"file".concat(e+1),url:t,status:"success"}}))}},handleSave:function(){var t=this;this.$refs.uploadEdit.submit(),this.showEditModal=!1,this.$message.success("商品信息已保存");var e=this.products.findIndex((function(e){return e.id===t.currentItem.id}));-1!==e&&(0!=this.fileList.length&&this.fileList.forEach((function(e){void 0!=e.url&&(t.currentItem.imageUrl=e.url)})),this.products.splice(e,1,this.currentItem));this.currentItem.id,this.currentItem.name,this.currentItem.title,this.currentItem.intro,this.currentItem.imageUrl,this.currentItem.price,this.currentItem.sellingPrice,this.currentItem.num,this.currentItem.sales,this.currentItem.categoryId;o.a.post("/api/product/editForm",{id:this.currentItem.id,name:this.currentItem.name,title:this.currentItem.title,intro:this.currentItem.intro,imageUrl:this.currentItem.imageUrl,price:this.currentItem.price,sellingPrice:this.currentItem.sellingPrice,num:this.currentItem.num,sales:this.currentItem.sales,categoryId:this.currentItem.categoryId},{headers:{"Content-Type":"application/json"}}).then((function(t){console.log(t.data)})).catch((function(t){console.error(t)})),this.resetForm()},upload:function(t,e,l){this.handleUploadSubmit(t,e,l)},handleUploadSubmitAdd:function(t){var e=this.products[this.products.length-1];e.imageUrl=t.data},handleUploadSubmit:function(t){this.currentItem.imageUrl=t.data.url,this.handleSuccess()},handleSuccess:function(){},handleRemove:function(t){console.log(t),this.$refs.uploadEdit.handleRemove(t);var e=this.fileList.indexOf(t);e>-1&&this.fileList.splice(e,1),o.a.post("/api/product/deletePhoto",{url:t.url})},handlePictureCardPreview:function(t){var e;console.log(t),e=(t.url,t.url),this.dialogVisible=!0,this.dialogImageUrl=e},handleDownload:function(t){console.log(t)},handleBeforeUpload:function(t,e){this.$message.warning("当前限制选择 1 个文件，已选择 ".concat(e.length," 个文件，本次选择的文件将不会上传"))},handleChange:function(t,e){this.fileList=e}}}),c=s,u=(l("aeb1"),l("2877")),d=Object(u["a"])(c,i,a,!1,null,null,null);e["default"]=d.exports}}]);