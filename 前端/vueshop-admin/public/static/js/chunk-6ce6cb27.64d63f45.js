(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ce6cb27"],{"0c80":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("el-button",{attrs:{icon:"el-icon-plus",type:"primary",plain:""},on:{click:function(t){return e.handleAdd()}}},[e._v("添 加商品")]),i("el-button",{attrs:{icon:"el-icon-delete",type:"danger",plain:"",disabled:0===e.multipleSelection.length},on:{click:function(t){return e.handleDeleteItem(e.multipleSelection)}}},[e._v("删除")])],1),i("div",[i("el-table",{directives:[{name:"load",rawName:"v-load"}],staticStyle:{width:"100%"},attrs:{data:e.products,border:!1},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection","show-overflow-tooltip":!0}}),e._v(" // 表头 "),i("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"730",align:"center"}}),e._v(" // 图片上传 "),i("el-table-column",{attrs:{label:"商品图片",width:"200px",prop:"imageUrl",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("div",[i("el-image",{attrs:{src:e.row.imageUrl[0],height:"180",width:"150"}})],1)]}}])}),i("el-table-column",{attrs:{label:"操作",width:"700",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleEdit(t.row)}}},[e._v("编辑")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1)],1),e.showForm?i("div",[i("el-dialog",{staticClass:"addForm",staticStyle:{"overflow-x":"hidden"},attrs:{visible:e.showForm,"close-on-click-modal":!1,"before-close":e.resetForm},on:{"update:visible":function(t){e.showForm=t}}},[i("el-scrollbar",{staticStyle:{height:"600px","overflow-x":"hidden","overflow-y":"auto"}},[i("el-form",{ref:"resetForm",on:{submit:function(t){return t.preventDefault(),e.addProduct(t)}}},[i("el-form-item",{attrs:{label:"商品名称："}},[i("el-input",{attrs:{type:"text",required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",[i("a",[e._v("picture:")]),i("el-upload",{ref:"addUpload",attrs:{action:"/api/goods/upload","file-list":e.fileList,"on-success":e.handleUploadSubmitAdd,data:e.form,"list-type":"picture-card","auto-upload":!1,"on-exceed":e.handleBeforeUpload,"on-change":e.handleChange},scopedSlots:e._u([{key:"file",fn:function(t){var n=t.file;return i("div",{},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:n.url,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(n)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleDownload(n)}}},[i("i",{staticClass:"el-icon-download"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(n)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,537993531)},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),i("el-button",{attrs:{type:"submit"},on:{click:e.addProduct}},[e._v("确认添加")]),i("el-button",{attrs:{type:"button"},on:{click:e.resetForm}},[e._v("取消")])],1)],1)],1),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1):e._e(),e.showEditModal?i("div",{staticClass:"editForm"},[i("el-dialog",{attrs:{visible:e.showEditModal,"close-on-click-modal":!1},on:{"update:visible":function(t){e.showEditModal=t}}},[i("el-form",{ref:"form",attrs:{model:e.currentItem},on:{submit:function(t){return t.preventDefault(),e.addProduct(t)}}},[i("el-form-item",{attrs:{label:"商品名称："}},[i("el-input",{attrs:{type:"text",required:""},model:{value:e.currentItem.name,callback:function(t){e.$set(e.currentItem,"name",t)},expression:"currentItem.name"}})],1),i("el-form-item",{attrs:{label:""}},[i("a",[e._v("图片：")]),i("el-upload",{ref:"editUpload",attrs:{action:"/api/goods/upload","list-type":"picture-card","auto-upload":!1,data:e.currentItem,"on-success":e.handleUploadSubmit,"on-exceed":e.handleBeforeUpload(7),"file-list":e.fileList},scopedSlots:e._u([{key:"file",fn:function(t){var n=t.file;return i("div",{},[i("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:n.url,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(n)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleDownload(n)}}},[i("i",{staticClass:"el-icon-download"})]),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleRemove(n)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,537993531)},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("确认编辑")]),i("el-button",{on:{click:function(t){e.showEditModal=!1}}},[e._v("取消")])],1)],1),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{attrs:{width:"50%",src:e.dialogImageUrl,alt:""}})])],1):e._e()])},l=[],a=i("c7eb"),o=i("1da1"),r=i("2909"),s=(i("d81d"),i("d3b7"),i("159b"),i("b0c0"),i("a434"),i("c740"),i("bc3a")),c=i.n(s),d={data:function(){return{products:[],showForm:!1,showEditForm:!1,form:{name:"",title:"",categoryId:"",intro:"",imageUrl:"",price:null,sellingPrice:null,num:null},showEditModal:!1,currentItem:{},multipleSelection:[],dialogImageUrl:[],dialogVisible:!1,disabled:!1,fileList:[],AddImgUrl:"",ProductName:"",deleteList:[]}},mounted:function(){this.getDetail()},methods:{getDetail:function(){var e=this;c.a.get("/api/goods/getDetail").then((function(t){e.products=t.data.data}))},handleAdd:function(){this.form={},this.fileList=[],this.showForm=!0},addProduct:function(){var e=this;this.$refs.addUpload.submit();var t=Math.max.apply(Math,Object(r["a"])(this.products.map((function(e){return e.id}))));this.products.forEach((function(e,t){e.id=t+1}));var i={id:t+1,name:this.form.name,price:this.form.price,imageUrl:[]};0===this.fileList.length?this.$nextTick((function(){e.$message.warning("请上传一个图片")})):(this.showForm=!1,this.products.push(i),this.$message.success("添加商品成功"),this.resetForm())},resetForm:function(){this.showForm=!1,this.form={name:"",price:null}},handleSelectionChange:function(e){this.multipleSelection=e},handleDelete:function(e){var t=this;this.deleteList=[],this.deleteList[0]=e.id;var i=this.deleteList;c.a.post("/api/goods/delete",i,{headers:{"Content-Type":"application/json"}}).then((function(i){if(200===i.data.code){var n=t.products.indexOf(e);-1!==n&&t.products.splice(n,1)}t.deleteList=[],200===i.data.code?t.$message(i.data.msg):t.$message.error(i.data.msg)})).catch((function(e){t.$message.error(e)}))},handleDeleteItem:function(e){var t=this;e.forEach((function(e){t.deleteList.push(e.id)})),c.a.post("/api/goods/delete",this.deleteList).then((function(i){200===i.data.code&&(0===e.length&&t.$message.error("请选择数据再点击"),t.deleteList=[],e.forEach((function(e){var i=t.products.findIndex((function(t){return t.id===e.id}));-1!==i&&t.products.splice(i,1)}))),t.fileList=[],200===i.data.code?t.$message(i.data.msg):t.$message.error(i.data.msg)})).catch((function(e){t.$message.error(e)}))},handleEdit:function(e){var t=this;return Object(o["a"])(Object(a["a"])().mark((function i(){return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:t.currentItem=Object.assign({},e),t.ProductName=t.currentItem.name,t.fileList=[],t.fileList=e.imageUrl.map((function(e,t){return{name:"file".concat(t+1),url:e,status:"success"}})),t.showEditModal=!0;case 5:case"end":return i.stop()}}),i)})))()},handleSave:function(){var e=this;this.showEditModal=!1;var t=this.products.findIndex((function(t){return t.id===e.currentItem.id}));if(this.$refs.editUpload.submit(),-1!==t){this.currentItem.imageUrl=[],this.fileList.forEach((function(t){void 0!=t.url&&e.currentItem.imageUrl.splice(e.currentItem.imageUrl.length,1,t.url)})),this.products.splice(t,1,this.currentItem);var i={name:this.currentItem.name,imageUrl:this.currentItem.imageUrl,id:this.currentItem.id};c.a.post("/api/goods/editForm",i).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}this.$message.success("商品信息已保存"),this.resetForm()},handleUploadSubmitAdd:function(e){var t=this.products[this.products.length-1];console.log(e),t.imageUrl.splice(t.imageUrl.length,1,e.data)},upload:function(){this.handleUploadSubmit()},handleUploadSubmit:function(e){this.currentItem.imageUrl.push(e.data.url),console.log(e)},handleSuccess:function(e,t,i){console.log(e.data.url)},handleRemove:function(e){this.$refs.editUpload.handleRemove(e);var t=this.fileList.indexOf(e);t>-1&&this.fileList.splice(t,1),c.a.post("/api/goods/deletePhoto",{url:e.url})},handlePictureCardPreview:function(e){var t;t=void 0!==e.url?e.url:e.imageUrl,console.log(t),this.dialogVisible=!0,this.dialogImageUrl=t},handleDownload:function(e){console.log(e)},handleBeforeUpload:function(){console.log(this.currentItem.imageUrl)},handleChange:function(e,t){this.fileList=t}}},u=d,m=(i("7b3d"),i("2877")),f=Object(m["a"])(u,n,l,!1,null,null,null);t["default"]=f.exports},"1f56":function(e,t,i){},2909:function(e,t,i){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function l(e){if(Array.isArray(e))return n(e)}i.d(t,"a",(function(){return s}));i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630");function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}i("fb6a"),i("b0c0"),i("ac1f"),i("00b4");function o(e,t){if(e){if("string"===typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e){return l(e)||a(e)||o(e)||r()}},"7b3d":function(e,t,i){"use strict";i("1f56")},a434:function(e,t,i){"use strict";var n=i("23e7"),l=i("23cb"),a=i("a691"),o=i("50c4"),r=i("7b0b"),s=i("65f0"),c=i("8418"),d=i("1dde"),u=i("ae40"),m=d("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),h=Math.max,p=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!m||!f},{splice:function(e,t){var i,n,d,u,m,f,v=r(this),w=o(v.length),_=l(e,w),y=arguments.length;if(0===y?i=n=0:1===y?(i=0,n=w-_):(i=y-2,n=p(h(a(t),0),w-_)),w+i-n>g)throw TypeError(b);for(d=s(v,n),u=0;u<n;u++)m=_+u,m in v&&c(d,u,v[m]);if(d.length=n,i<n){for(u=_;u<w-n;u++)m=u+n,f=u+i,m in v?v[f]=v[m]:delete v[f];for(u=w;u>w-n+i;u--)delete v[u-1]}else if(i>n)for(u=w-n;u>_;u--)m=u+n-1,f=u+i-1,m in v?v[f]=v[m]:delete v[f];for(u=0;u<i;u++)v[u+_]=arguments[u+2];return v.length=w-n+i,d}})},c740:function(e,t,i){"use strict";var n=i("23e7"),l=i("b727").findIndex,a=i("44d2"),o=i("ae40"),r="findIndex",s=!0,c=o(r);r in[]&&Array(1)[r]((function(){s=!1})),n({target:"Array",proto:!0,forced:s||!c},{findIndex:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),a(r)}}]);